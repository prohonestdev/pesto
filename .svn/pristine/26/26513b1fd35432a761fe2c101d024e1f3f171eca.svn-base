
function formationOfDate(e) {
	if (e < 10) {
		e = '0' + e;
	}
	return e;
}

function initializeMenuCarousel() {
	$('.menu-slider').owlCarousel({
			autoplayTimeout: 5000,
			autoplayHoverPause: true,
			autoplay: true,
			loop: true,
			margin: 10,
			nav: false,
			touchDrag: true,
			mouseDrag: true,
			dots: true,
			items: 1
		});
}


function setCarousel() 
{
    if (($.isFunction($.fn.show) && $.isFunction($.fn.revolution))) {
		$('.rev_slider').each(function(){
			revapi = $(this).show().revolution({
				sliderType: 'carousel',                
				gridwidth: 1230,
				gridheight: 720,
				navigation: {
					keyboardNavigation: 'off',
					keyboard_direction: 'horizontal',
					mouseScrollNavigation: 'off',
					onHoverStop: 'off',
					arrows: {
						style: 'rev_pesto',
						enable: true,
						hide_onmobile: true,
						hide_under: 600,
						hide_onleave: true,
						hide_delay: 200,
						hide_delay_mobile: 1200,
						tmp: '<div class="tp-title-wrap">     <span class="tp-arr-titleholder">{{title}}</span> </div>',
						left: {
							h_align: 'left',
							v_align: 'center',
							h_offset: 30,
							v_offset: 0
						},
						right: {
							h_align: 'right',
							v_align: 'center',
							h_offset: 30,
							v_offset: 0
						}
					}
					,
					thumbnails: {
						style: 'rev_pesto',
						enable: true,
						width: 20,
						height: 20,
						min_width: 14,
						wrapper_padding: 0,
						wrapper_color: 'transparent',
						wrapper_opacity: '1',
						tmp: '<span class="tp-thumb-icon-circle"><i class="fa fa-circle"></i></span>',
						visibleAmount: 5,
						hide_onmobile: true,
						hide_under: 800,
						hide_onleave: true,
						direction: 'horizontal',
						span: false,
						position: 'inner',
						space: 5,
						h_align: 'center',
						v_align: 'bottom',
						h_offset: 0,
						v_offset: 20
					}
				},
				carousel:{
					horizontal_align: 'center',
					vertical_align : 'center',
					infinity : 'on',
					space : 0,
					maxVisibleItems : 3,                        
					stretch: 'on',                        
					fadeout: 'on',                        
					maxRotation: 0,                        
					minScale: 0,
					vary_fade: 'off',
					vary_rotation: 'on',
					vary_scale: 'off',                        
					border_radius: '0px',
					padding_top: 0,
					padding_bottom: 0
				}
			});  	
		});
		
		$('.rev_slider3').each(function(){
			revapi = $(this).show().revolution({
				sliderType: 'carousel',                
				responsiveLevels: [2048,1024,768,480],
				sliderLayout: 'fullscreen',
				navigation: {
					keyboardNavigation: 'off',
					keyboard_direction: 'horizontal',
					mouseScrollNavigation: 'off',
					onHoverStop: 'off',
					arrows: {
						style: 'rev_pesto',
						enable: true,
						hide_onmobile: true,
						hide_under: 600,
						hide_onleave: true,
						hide_delay: 200,
						hide_delay_mobile: 1200,
						tmp: '<div class="tp-title-wrap">     <span class="tp-arr-titleholder">{{title}}</span> </div>',
						left: {
							h_align: 'left',
							v_align: 'center',
							h_offset: 42,
							v_offset: 0
						},
						right: {
							h_align: 'right',
							v_align: 'center',
							h_offset: 42,
							v_offset: 0
						}
					}
					,
					thumbnails: {
						style: 'rev_pesto',
						enable: true,
						width: 20,
						height: 20,
						min_width: 14,
						wrapper_padding: 0,
						wrapper_color: 'transparent',
						wrapper_opacity: '1',
						tmp: '<span class="tp-thumb-icon-circle"><i class="fa fa-circle"></i></span>',
						visibleAmount: 5,
						hide_onmobile: true,
						hide_under: 800,
						hide_onleave: true,
						direction: 'horizontal',
						span: false,
						position: 'inner',
						space: 5,
						h_align: 'center',
						v_align: 'bottom',
						h_offset: 0,
						v_offset: 20
					}
				},
				carousel:{
					horizontal_align: 'center',
					vertical_align : 'center',
					infinity : 'on',
					space : 0,
					maxVisibleItems : 3,                        
					stretch: 'on',                        
					fadeout: 'on',                        
					maxRotation: 0,                        
					minScale: 0,
					vary_fade: 'off',
					vary_rotation: 'on',
					vary_scale: 'off',                        
					border_radius: '0px',
					padding_top: 0,
					padding_bottom: 0
				}
			});  	
		});
		
		$('.rev_slider2').each(function(){
				revapi = $(this).revolution({
				sliderType: 'carousel',                
				gridwidth: 430,
				gridheight: 430,
				navigation: {
					keyboardNavigation: 'off',
					keyboard_direction: 'horizontal',
					mouseScrollNavigation: 'off',
					onHoverStop: 'on',
					arrows: {
						style: 'rev_pesto',
						enable: true,
						hide_onmobile: false,
						hide_under: 600,
						hide_onleave: true,
						hide_delay: 200,
						hide_delay_mobile: 1200,
						tmp: '',
						left: {
							h_align: 'left',
							v_align: 'center',
							h_offset: 30,
							v_offset: 0
						},
						right: {
							h_align: 'right',
							v_align: 'center',
							h_offset: 30,
							v_offset: 0
						}
					}
					,
					thumbnails: {
						style: 'rev_pesto',
						enable: true,
						width: 20,
						height: 20,
						min_width: 14,
						wrapper_padding: 0,
						wrapper_color: 'transparent',
						wrapper_opacity: '1',
						tmp: '<span class="tp-thumb-icon-circle"><i class="fa fa-circle"></i></span>',
						visibleAmount: 5,
						hide_onmobile: false,
						hide_under: 800,
						hide_onleave: false,
						direction: 'horizontal',
						span: true,
						position: 'inner',
						space: 5,
						h_align: 'center',
						v_align: 'bottom',
						h_offset: 0,
						v_offset: 20
					}
				},
				carousel:{
					horizontal_align: 'center',
					vertical_align : 'center',
					infinity : 'on',
					space : 0,
					maxVisibleItems : 3,                        
					stretch: 'on',                        
					fadeout: 'on',                        
					maxRotation: 0,                        
					minScale: 0,
					vary_fade: 'off',
					vary_rotation: 'on',
					vary_scale: 'off',                        
					border_radius: '0px',
					padding_top: 0,
					padding_bottom: 0
				}
			});
		});
    }
	// Set Owl Carousel
	if ($.isFunction($.fn.owlCarousel)) {
		$(".theme-owl-carousel.owl-theme").each(function() {
			$(this).owlCarousel({
				autoplayTimeout: 5000,
				autoplayHoverPause: true,
				autoplay: true,
				loop: true,
				margin: 10,
				nav: false,
				touchDrag: true,
				mouseDrag: true,
				dots: true,
				responsive:{
					0:{
						items:1
					},
					600:{
						items:1
					},
					1000:{
						items:1
					}
				}
			});
		});
		$(".theme-owl-carousel.over-comment").each(function() {
			$(this).owlCarousel({
				autoplayTimeout: 5000,
				autoplayHoverPause: true,
				autoplay: true,
				loop: true,
				margin: 10,
				nav: false,
				touchDrag: true,
				mouseDrag: true,
				dots: true,
				responsive:{
					0:{
						items:1
					},
					600:{
						items:1
					},
					1000:{
						items:1
					}
				}
			});
		});
		$(".theme-owl-carousel.right-comment").each(function() {
			$(this).owlCarousel({
				autoplayTimeout: 5000,
				autoplayHoverPause: true,
				autoplay: true,
				loop: true,
				margin: 40,
				nav: true,
				touchDrag: true,
				mouseDrag: true,
				dots: false,
				navText: ['<span> <i class="fa fa-chevron-left"></i> </span>','<span> <i class="fa fa-chevron-right"></i> </span>'],
				responsive:{
					0:{
						items:1,
						margin: 5
					},
					860:{
						items:2,
						margin: 25
					},
					1300:{
						items:3,
						margin: 40
					}

				}
			});
		});
    }
}

function setVisualState() {
	$('.smart_input').each(function() {
		$value = $(this).val();

		if ($(this).is(':checked')) {
			$(this).next().addClass("checked");
		}
		else {
			$(this).next().removeClass("checked");
		}
	});
}

function setEvent() {
    setVisualState();
	
    //add event here
	$('.smart_input').change(function() {
		setVisualState();
    });
}


function setSelect() {
    // Override defaults
	if (($.isFunction($.fn.selectpicker))) {
		$.fn.selectpicker.defaults = {
			iconBase: '',
			tickIcon: 'icon-checkmark3'
		}
		
		// Basic select
		if ($('.bootstrap-select').length)
		{
			$('.bootstrap-select').selectpicker();
		}

	}
}

function setSlider()
{
    
	// Set Slider
    if (($.isFunction($.fn.slider))) {
		$('.slider-range').each(function(){
			var $start_value, $end_value;
			
			$start_value 	= 250;
			$end_value 		= 750;
			
			$(this).slider({
				range: true,
				min: 0,
				max: 1000,
				values: [ $start_value, $end_value ],
				slide: function( event, ui ) {
					$( ".amount-start", $(this).parent(), $(this).parent() ).val('$'+ui.values[ 0 ]);
					$( ".amount-end", $(this).parent() ).val('$'+ui.values[ 1 ]);
				}
			});
			
			$(".amount-start", $(this).parent()).val('$'+$(this).slider( "values", 0 ));
			$( ".amount-end", $(this).parent()).val('$'+$(this).slider( "values", 1 ));	
		});
        
		$('.slider-default').each(function(){
			$(this).slider();
		});

		$('.slider-range-min').each(function(){
			$(this).slider({
				range: "min",
				value: 100,
				min: 1,
				max: 700,
				slide: function( event, ui ) {
				$( ".amount", $(this).parent() ).val( "$" + ui.value );
				}
			});
			$( ".amount", $(this).parent() ).val( "$" + $(this).slider( "value" ) );
		});
		
		$('.slider-range-max').each(function(){
			$(this).slider({
				range: "max",
				value: 100,
				min: 1,
				max: 700,
				slide: function( event, ui ) {
				$( ".amount", $(this).parent() ).val( "$" + ui.value );
				}
			});
			$( ".amount", $(this).parent() ).val( "$" + $(this).slider( "value" ) );
		});
    }
}


function initializeMap() {
    var mapMarkers = [{
                address: 'New York, NY 10017',
                html: '<strong>New York Office</strong><br>New York, NY 10017',
                icon: {
                    image: 'img/pin.png',
                    iconsize: [26, 46],
                    iconanchor: [12, 46]
                },
                popup: true
            }];

            // Map Initial Location
            var initLatitude = 40.75198;
            var initLongitude = -73.96978;

            // Map Extended Settings
            var mapSettings = {
                controls: {
                    panControl: true,
                    zoomControl: true,
                    mapTypeControl: true,
                    scaleControl: true,
                    streetViewControl: true,
                    overviewMapControl: true
                },
                scrollwheel: false,
                markers: mapMarkers,
                latitude: initLatitude,
                longitude: initLongitude,
                zoom: 16
            };

            var map = $('#google_map').gMap(mapSettings);

            // Map Center At
            var mapCenterAt = function(options, e) {
                e.preventDefault();
                $('#google_map').gMap('centerAt', options);
            }
}

function menuFixed(fixedClass,flag) {
    if (flag == 'add') {
        if (!fixedClass.hasClass('fixed-top')) {
            fixedClass.addClass('fixed-top');
        }
    }
    else {
        if (fixedClass.hasClass('fixed-top')) {
            fixedClass.removeClass('fixed-top');
        }    
    }        
}
function refreshHeader3() {
	var headerHeight = $('.header-body').height();
	var windowHeight = $(window).height();
	var difference = headerHeight - windowHeight;
	if (difference > 0) {
		$('.header-body').not('.fixed-bottom').css('position','absolute').css('top','auto');
		if ($(window).scrollTop() > difference ) {
			$('.header-body').addClass('fixed-bottom');
		}
		else if ($(window).scrollTop() <= difference && $('.header-body').hasClass('fixed-bottom')){
			$('.header-body').removeClass('fixed-bottom');
		}
	}
	else {
		$('.header-body').css('position','fixed');				
		$('.header-body').css('top','0');
	}
}

$(document).ready(function() {

    setCarousel();
    setEvent();
	setSelect();
    setSlider();
	
	//Calcualte height of left-sidebar header when left-sidebar header is clicked
	$('.left-sidebar .header-body.fixed-bottom *').click(function(){
		var headerHeight = $('.header-body').height();
		var windowHeight = $(window).height();
		var difference = headerHeight - windowHeight;
		if (difference < 0) { 
			$('.header-body').removeClass('fixed-bottom').css('position','absolute');
			$('.header-body').css('top','0');
		}
	});
	
    // Refresh Menu when size of window change
    $(window).resize(function(){
    	if ($(window).scrollTop() > 0) {
    		if ($('.left-sidebar').length == 0 || ($('.left-sidebar').length && $(window).width() < 992)) {
    			 menuFixed($('.header-body'),'add');
    		}
			else if ($('.left-sidebar').length) {
				$('.header-body.fixed-top').removeClass('fixed-top');
				$('.header-body').css('top',0);
			}
    	}
    	if ($(window).width() > 991) {
    		$('#header').find('.droped').removeClass('droped').slideUp(100);
    		if ($('.left-sidebar').length) {
    			$('.header-body.fixed-top').removeClass('fixed-top');
    		}
     	}
		
    });
	// Header fixed
	if (('#header').length) {
		if ($(window).scrollTop() > 0) {
			if ($(window).width() < 992 || $('.left-sidebar').length == 0 ) {
				menuFixed($('.header-body'),'add');
			}
		}
	    $(window).scroll(function() {
	    	if ($(window).width() < 992 || $('.left-sidebar').length == 0 ) {
		        if (0 < $(window).scrollTop())
		        {
		            menuFixed($('.header-body'),'add');    
		        }
		        else {
		            menuFixed($('.header-body'),'remove');
		        }          
	    	}
			else if ($('.left-sidebar').length && $(window).width() > 991 ) {
				refreshHeader3();
			}
	    });
    }
	
	// Dropdown-menu droped when header top links hover
    $('.header-top-links .dropdown').mouseenter(function() {
        var el = $(this).children('.dropdown-menu');
        if ($(window).width() > 991) {
            el = $(this).children('.dropdown-menu').not('.droped,.right');
        }
        else {
            el = $(this).children('.dropdown-menu').not('.droped');
        }
        $(el).addClass('droped').slideDown(100);
    }).mouseleave(function(){
        var el = $(this).children('.dropdown-menu');
        if ($(window).width() > 991) {
            el = $(this).children('.dropdown-menu.droped').not('.right');
        }
        else {
            el = $(this).children('.dropdown-menu.droped');
        }
        $(el).slideUp(100).removeClass("droped");
    });

    $('.header-top-links .dropdown-search a.dropdown-toggle').click(function(e) {
        e.stopPropagation();
        $(this).siblings('.dropdown-menu').not('.droped').slideDown("slow").addClass('droped');
    });


    $('.header-top-links .dropdown-search .dropdown-menu').mouseleave(function() {
        $(this).slideUp().removeClass("droped");
    });
 
	if ($.isFunction($.fn.owlCarousel) ) {
		$('.product-owl-carousel').owlCarousel({
            items:4,
            loop:true,
            margin:22,
            nav: true,
            touchDrag: true,
			mouseDrag: true,
            navText: ['<span> <i class="fa fa-angle-left"></i> </span>','<span> <i class="fa fa-angle-right"></i> </span>']
        });
        
        $('.shop .owl-carousel').on('translated.owl.carousel', function(event) {
            var items = $(this).find('.owl-item.active > .owl-item');
            $.each(items , function(index,value){
                if (index != 1 && $(value).hasClass('owl-sel')){
                    $(value).removeClass('owl-sel');
                }
                else if(index == 1 && !$(value).hasClass('owl-sel')){
                    $(value).addClass('owl-sel');
                }    
            });
        });
	}
    
    if ($('.select ul').length) {
        $('.select ul li').click(function(){
            $.each($(this).siblings(),function(index,value) {
                if ($(value).hasClass('selected')){
                    $(value).removeClass('selected');
                }                  
            })
            
            if (!$(this).hasClass('selected')) {
                $(this).addClass('selected');
                $(this).parents('.select').children('select').val($(this).attr('value'));
            }    
        });        
    }

    // google map
    if ($('#google_map').length){
        initializeMap();        
    }
    
    if ($('.fancybox').length){
        $('.fancybox').fancybox({
        	tpl: {
        		closeBtn : '<a title="Close" class="fancybox-item fancybox-close" href="javascript:;"></a>',
				next     : '<a title="Next" class="fancybox-nav fancybox-next" href="javascript:;"><span></span></a>',
				prev     : '<a title="Previous" class="fancybox-nav fancybox-prev" href="javascript:;"><span></span></a>'
        	}
        });        
    }
    
    if ($('.header-btn-search').length){
        $('.header-btn-search').click(function(){
            $('.header-top-links .dropdown-search .dropdown-menu').not('.droped').slideDown().addClass('droped');
        });
    }

    if ($('.header-btn-cart').length){
        $('.header-btn-cart').click(function(){
            $('.header-top-links .mini-cart .dropdown-menu').not('.droped').slideDown();
            $('.header-top-links .mini-cart .dropdown-menu.droped').slideUp();
            $('.header-top-links .mini-cart .dropdown-menu').toggleClass("droped");
        });
    }
    // menu
    if ($('.header-main-nav .dropdown').length) {
        $('.dropdown').click(function(e){
            if ($(window).width() < 992 || $('.left-sidebar').length) {
                e.stopPropagation();
                $(this).find('>.dropdown-menu').not('.droped').slideDown('slow');
                $(this).find('.dropdown-menu.droped').slideUp('400',function(){
					if ($('.left-sidebar').length && $(window).width() > 991 ){
						setTimeout(refreshHeader3(),400);
					}
				});
                $(this).find('>.dropdown-menu').toggleClass('droped');
                $(this).find('.dropdown-menu .dropdown-menu.droped').removeClass('droped');
                $(this).find('>.dropdown-table-sub-nav.droped').removeClass('droped').slideUp('slow');
				
            }
			
        });   
    }
    //dropdown-table 
    $('.dropdown-table').hover(function(){
    	if ($(window).width()>=992 && $('.left-sidebar').length==0 && $(this).find('.menu-slider').length) {
    		if($(this).find('.menu-slider.owl-carousel').length) {
    			$(this).find('.menu-slider').trigger('refresh.owl.carousel');
    		}
    		initializeMenuCarousel();
    	}
    });
    // submenu
    if ($('.dropdown-table-sub-title').length) {
        $('.dropdown-table-content >li').click(function(e){
            e.stopPropagation();
            if ($(window).width() <= 992  || $('.left-sidebar').length){
                $(this).siblings().find('.dropdown-table-sub-nav.droped').slideUp('slow').removeClass('droped');
                if ($(this).find('.dropdown-table-sub-nav').hasClass('droped')) {
                    $(this).find('.dropdown-table-sub-nav').removeClass('droped').slideUp('slow');    
                }
                else {
                    $(this).find('.dropdown-table-sub-nav').addClass('droped').slideDown('slow');
                }
            }
        });
    }

    if ($('.remain-time').length) {
    	setInterval(function() {
    		var date = new Date();
    		var day = $('.day h4').html()*1;
    		var hour = $('.hour h4').html()*1;
    		var minute = $('.minute h4').html()*1;
    		var second = $('.second h4').html()*1;
    		second -= 1;
    		if (second < 0 ) {
    			second = 59;
    			minute -= 1;
    		}
    		if (minute < 0) {
    			minute = 59;
    			hour -= 1;
    		}
    		if (hour < 0) {
    			hour = 23;
    			day -= 1;
    		}
    		if (day < 0) {
    			day = hour = minute = second = 0;
    		}
    		second = formationOfDate(second);
    		minute = formationOfDate(minute);
    		hour = formationOfDate(hour);
    		day = formationOfDate(day);
    		$('.day h4').html(day);
    		$('.hour h4').html(hour);
    		$('.minute h4').html(minute);
    		$('.second h4').html(second);
    	},1000);	
    }
    if ($.isFunction($.fn.isotope)) {
    	var $grid = $('.grid').imagesLoaded(function() {
            $grid.isotope({
                itemSelector: '.grid-item',
                layoutMode: 'fitRows'
              });  
        })
	  	var $masonry_grid=$('.masonry-grid').imagesLoaded(function(){
            $masonry_grid.isotope({
                    layoutMode: 'packery',
                    itemSelector: '.grid-item',
                    getSortData: {
                        latest: '.title',
                        popular: '.category',
                        featured: '.image'
                    }
                  });
        });
        

    }
    $('.btn-load-more').click(function() {
    	$(this).css('display','none');
    	if ($('.products .grid').length) {
	    	var $items = $('.products .load-more .grid-item');
		    $grid.append($items).isotope( 'appended', $items );
    	}
    	if ($('.products .masonry-grid').length) {
    		var $items = $('.products .load-more .grid-item');
    		$masonry_grid.append($items).isotope( 'appended', $items );
    	}
    });
    $('.filter').click(function() {
    	if ($.isFunction($.fn.isotope)) {
	    	var filterContainer = $(this).parent().parent().attr('data-object');
	    	var filterValue = $(this).attr('data-filter');
	    	if (filterContainer.substr(1,1) == "." || filterContainer.substr(1,1) == "#") {
	    		filterContainer = filterContainer.substr(1);
	    	}
	    	filterContainer = filterContainer.replace("-","_");
	    	filterContainer = "$" + filterContainer;
	    	eval(filterContainer).isotope({filter : filterValue});
	    }
    })
    $('.sort').click(function(){
    	if ($.isFunction($.fn.isotope)) {
	    	var sortContainer = $(this).parent().parent().attr('data-object');
	    	var sortValue = $(this).attr('data-sort-value');
	    	if (sortContainer.substr(1,1) == "." || sortContainer.substr(1,1) == "#") {
	    		sortContainer = sortContainer.substr(1);
	    	}
	    	sortContainer = sortContainer.replace("-","_");
	    	sortContainer = "$" + sortContainer;
	    	eval(sortContainer).isotope({sortBy : sortValue});
	    }
    });
    $('.image').click(function(){
    	if ($(this).find('>a').length)
			window.location.assign($(this).find('>a').attr('href'));
    });
    $('.over-comment .links > *').click(function(e){
    	e.stopPropagation();
    });
    // mobile menu close
    if ($('.menu-close').length) {
        $('.menu-close').click(function(){
            $(this).parents('.droped').slideUp('slow').removeClass('droped');
        })
    }
});


